<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>GGStandoff WebApp</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: var(--tg-theme-bg-color, #1a1a2e);
            color: var(--tg-theme-text-color, #ffffff);
            padding: 16px;
            min-height: 100vh;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        h1 {
            font-size: 28px;
            margin-bottom: 8px;
            color: var(--tg-theme-button-color, #e94560);
        }

        .subtitle {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 24px;
        }

        .menu-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 12px;
            margin-bottom: 24px;
        }

        .menu-item {
            background-color: var(--tg-theme-secondary-bg-color, #16213e);
            border: none;
            border-radius: 12px;
            padding: 16px 8px;
            color: var(--tg-theme-text-color, #ffffff);
            font-size: 16px;
            font-weight: 500;
            cursor: pointer;
            transition: transform 0.1s, opacity 0.1s;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
        }

        .menu-item:active {
            transform: scale(0.97);
            opacity: 0.8;
        }

        .menu-item span {
            font-size: 24px;
        }

        .content-card {
            background-color: var(--tg-theme-secondary-bg-color, #16213e);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .back-button {
            background-color: var(--tg-theme-button-color, #e94560);
            color: var(--tg-theme-button-text-color, #ffffff);
            border: none;
            border-radius: 12px;
            padding: 12px 20px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            width: 100%;
            margin-top: 16px;
        }

        .balance-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background-color: rgba(0,0,0,0.3);
            padding: 12px 16px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .balance-amount {
            font-size: 20px;
            font-weight: bold;
            color: var(--tg-theme-button-color, #e94560);
        }

        .case-list {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .case-item {
            background-color: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 16px;
            cursor: pointer;
            transition: background 0.2s;
        }

        .case-item:active {
            background-color: rgba(0,0,0,0.4);
        }

        .case-name {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 4px;
        }

        .case-price {
            color: var(--tg-theme-hint-color, #a0a0a0);
            font-size: 14px;
        }

        .case-description {
            font-size: 13px;
            margin-top: 8px;
            opacity: 0.8;
        }

        .count-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }

        .count-btn {
            background-color: var(--tg-theme-bg-color, #0f3460);
            color: var(--tg-theme-text-color, #ffffff);
            border: 1px solid var(--tg-theme-button-color, #e94560);
            border-radius: 30px;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            flex: 1 0 auto;
            min-width: 70px;
        }

        .count-btn.selected {
            background-color: var(--tg-theme-button-color, #e94560);
            color: var(--tg-theme-button-text-color, #ffffff);
            border-color: var(--tg-theme-button-color, #e94560);
        }

        .inventory-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 12px;
        }

        .inventory-item {
            background-color: rgba(0,0,0,0.2);
            border-radius: 12px;
            padding: 12px;
            text-align: center;
        }

        .inventory-item .rarity {
            font-size: 20px;
            margin-bottom: 4px;
        }

        .inventory-item .name {
            font-weight: 500;
            font-size: 14px;
            word-break: break-word;
        }

        .inventory-item .price {
            font-size: 12px;
            color: var(--tg-theme-hint-color, #a0a0a0);
            margin-top: 4px;
        }

        .sell-btn {
            background-color: var(--tg-theme-button-color, #e94560);
            color: white;
            border: none;
            border-radius: 20px;
            padding: 6px 12px;
            font-size: 12px;
            margin-top: 8px;
            cursor: pointer;
        }

        .modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background-color: var(--tg-theme-secondary-bg-color, #16213e);
            border-radius: 20px;
            padding: 24px;
            max-width: 90%;
            max-height: 80%;
            overflow-y: auto;
        }

        .result-item {
            padding: 12px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .result-item:last-child {
            border-bottom: none;
        }

        .loading {
            text-align: center;
            padding: 40px;
            font-size: 18px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container" id="app">
        <!-- –ì–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω -->
        <div id="mainScreen">
            <h1>GGStandoff</h1>
            <div class="subtitle">–í–∞—à —ñ–≥—Ä–æ–≤–∏–π –ø–æ–º—ñ—á–Ω–∏–∫</div>

            <div class="balance-info" id="balanceInfo">
                <span>üí∞ –ë–∞–ª–∞–Ω—Å:</span>
                <span class="balance-amount" id="balanceAmount">0</span>
            </div>

            <div class="menu-grid">
                <button class="menu-item" onclick="showCases()">
                    <span>üì¶</span> –ö–µ–π—Å–∏
                </button>
                <button class="menu-item" onclick="showInventory()">
                    <span>üéí</span> –Ü–Ω–≤–µ–Ω—Ç–∞—Ä
                </button>
                <button class="menu-item" onclick="showProfile()">
                    <span>üë§</span> –ü—Ä–æ—Ñ—ñ–ª—å
                </button>
                <button class="menu-item" onclick="showMarket()">
                    <span>üè™</span> –ú–∞—Ä–∫–µ—Ç
                </button>
                <button class="menu-item" onclick="showDuels()">
                    <span>‚öîÔ∏è</span> –î—É–µ–ª—ñ
                </button>
                <button class="menu-item" onclick="showTournament()">
                    <span>üèÜ</span> –¢—É—Ä–Ω—ñ—Ä
                </button>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –∫–µ–π—Å—ñ–≤ -->
        <div id="casesScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>üì¶ –ö–µ–π—Å–∏</h2>
                <div id="casesList" class="case-list"></div>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –≤–∏–±–æ—Ä—É –∫—ñ–ª—å–∫–æ—Å—Ç—ñ –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∫–µ–π—Å—É -->
        <div id="caseDetailScreen" class="hidden">
            <button class="back-button" onclick="showCases()">‚óÄÔ∏è –î–æ —Å–ø–∏—Å–∫—É</button>
            <div class="content-card">
                <h2 id="caseDetailName"></h2>
                <p id="caseDetailDesc"></p>
                <div class="balance-info" style="margin-top: 16px;">
                    <span>üí∞ –í–∞—à –±–∞–ª–∞–Ω—Å:</span>
                    <span class="balance-amount" id="caseDetailBalance">0</span>
                </div>
                <div class="count-selector" id="countSelector"></div>
                <button class="back-button" id="openCaseBtn" onclick="openCase()" style="margin-top: 0;">üîì –í—ñ–¥–∫—Ä–∏—Ç–∏</button>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ–≤ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è -->
        <div id="resultScreen" class="hidden">
            <button class="back-button" onclick="goBackToCases()">‚óÄÔ∏è –ü—Ä–æ–¥–æ–≤–∂–∏—Ç–∏</button>
            <div class="content-card">
                <h2>üéâ –†–µ–∑—É–ª—å—Ç–∞—Ç–∏</h2>
                <div id="resultsList"></div>
                <div class="balance-info" style="margin-top: 16px;">
                    <span>üí∞ –ù–æ–≤–∏–π –±–∞–ª–∞–Ω—Å:</span>
                    <span class="balance-amount" id="newBalanceResult">0</span>
                </div>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—è -->
        <div id="inventoryScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>üéí –Ü–Ω–≤–µ–Ω—Ç–∞—Ä</h2>
                <button class="back-button" onclick="sellAllInventory()" style="margin: 10px 0; background-color: #ff9800;">üí∞ –ü—Ä–æ–¥–∞—Ç–∏ –≤—Å—ñ</button>
                <div id="inventoryList" class="inventory-grid"></div>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –ø—Ä–æ—Ñ—ñ–ª—é -->
        <div id="profileScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>üë§ –ü—Ä–æ—Ñ—ñ–ª—å</h2>
                <div id="profileInfo"></div>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –º–∞—Ä–∫–µ—Ç—É (–∑–∞–≥–ª—É—à–∫–∞) -->
        <div id="marketScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>üè™ –ú–∞—Ä–∫–µ—Ç</h2>
                <p>–†–æ–∑–¥—ñ–ª —É —Ä–æ–∑—Ä–æ–±—Ü—ñ. –ù–µ–∑–∞–±–∞—Ä–æ–º —Ç—É—Ç –∑'—è–≤–∏—Ç—å—Å—è –º–æ–∂–ª–∏–≤—ñ—Å—Ç—å –∫—É–ø—É–≤–∞—Ç–∏ —Ç–∞ –ø—Ä–æ–¥–∞–≤–∞—Ç–∏ —Å–∫—ñ–Ω–∏.</p>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω –¥—É–µ–ª–µ–π (–∑–∞–≥–ª—É—à–∫–∞) -->
        <div id="duelsScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>‚öîÔ∏è –î—É–µ–ª—ñ</h2>
                <p>–†–æ–∑–¥—ñ–ª —É —Ä–æ–∑—Ä–æ–±—Ü—ñ. –°–∫–æ—Ä–æ –≤–∏ –∑–º–æ–∂–µ—Ç–µ –±–∏—Ç–∏—Å—è –∑ —ñ–Ω—à–∏–º–∏ –≥—Ä–∞–≤—Ü—è–º–∏!</p>
            </div>
        </div>

        <!-- –ï–∫—Ä–∞–Ω —Ç—É—Ä–Ω—ñ—Ä—É (–∑–∞–≥–ª—É—à–∫–∞) -->
        <div id="tournamentScreen" class="hidden">
            <button class="back-button" onclick="goBack()">‚óÄÔ∏è –ù–∞–∑–∞–¥</button>
            <div class="content-card">
                <h2>üèÜ –¢—É—Ä–Ω—ñ—Ä</h2>
                <p>–†–æ–∑–¥—ñ–ª —É —Ä–æ–∑—Ä–æ–±—Ü—ñ. –°–ª—ñ–¥–∫—É–π—Ç–µ –∑–∞ –∞–Ω–æ–Ω—Å–∞–º–∏!</p>
            </div>
        </div>
    </div>

    <script>
        // ==================== –ù–ê–õ–ê–®–¢–£–í–ê–ù–ù–Ø ====================
        const API_BASE_URL = 'https://your-server.com/api'; // ‚ö†Ô∏è –ó–ê–ú–Ü–ù–Ü–¢–¨ –ù–ê –ê–î–†–ï–°–£ –í–ê–®–û–ì–û –°–ï–†–í–ï–†–ê

        // –ì–ª–æ–±–∞–ª—å–Ω—ñ –∑–º—ñ–Ω–Ω—ñ
        let tg = window.Telegram.WebApp;
        let userId = tg.initDataUnsafe.user?.id;
        let userData = null;
        let currentCaseKey = null;
        let selectedCount = 1;
        let casesData = []; // –±—É–¥–µ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–æ –∑ —Å–µ—Ä–≤–µ—Ä–∞ –∞–±–æ –∑ –∫–æ–Ω—Ñ—ñ–≥—É

        // –Ü–Ω—ñ—Ü—ñ–∞–ª—ñ–∑–∞—Ü—ñ—è
        tg.expand();
        tg.ready();

        // –Ø–∫—â–æ userId –Ω–µ –≤–∏–∑–Ω–∞—á–µ–Ω–æ (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ –≤ –±—Ä–∞—É–∑–µ—Ä—ñ)
        if (!userId) {
            userId = prompt("–í–≤–µ–¥—ñ—Ç—å –≤–∞—à Telegram ID –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è:", "123456789");
        }

        // –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–æ—á–∞—Ç–∫–æ–≤–∏—Ö –¥–∞–Ω–∏—Ö
        loadProfile();

        // ==================== –§–£–ù–ö–¶–Ü–á API ====================
        async function apiCall(endpoint, data = {}) {
            data.user_id = userId;
            try {
                const response = await fetch(`${API_BASE_URL}/${endpoint}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(data)
                });
                return await response.json();
            } catch (error) {
                console.error('API Error:', error);
                return { success: false, message: '–ü–æ–º–∏–ª–∫–∞ –∑'—î–¥–Ω–∞–Ω–Ω—è –∑ —Å–µ—Ä–≤–µ—Ä–æ–º' };
            }
        }

        // ==================== –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ü–†–û–§–Ü–õ–Æ ====================
        async function loadProfile() {
            const data = await apiCall('profile');
            if (data.success) {
                userData = data.profile;
                updateBalanceDisplay(userData.balance);
                // –¢—É—Ç –º–æ–∂–Ω–∞ —Ç–∞–∫–æ–∂ –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –∫–µ–π—Å–∏ (–≤–æ–Ω–∏ –º–æ–∂—É—Ç—å –±—É—Ç–∏ –∑ config)
                loadCasesFromConfig(); // –∞–±–æ –∑ API, —è–∫—â–æ —î —Ç–∞–∫–∏–π –µ–Ω–¥–ø–æ—ñ–Ω—Ç
            } else {
                showNotification('–ù–µ –≤–¥–∞–ª–æ—Å—è –∑–∞–≤–∞–Ω—Ç–∞–∂–∏—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å');
            }
        }

        function updateBalanceDisplay(balance) {
            document.getElementById('balanceAmount').innerText = balance;
            document.getElementById('caseDetailBalance').innerText = balance;
        }

        // ==================== –ó–ê–í–ê–ù–¢–ê–ñ–ï–ù–ù–Ø –ö–ï–ô–°–Ü–í (–∑ –∫–æ–Ω—Ñ—ñ–≥—É) ====================
        function loadCasesFromConfig() {
            // –¢—É—Ç –º–∏ —ñ–º—ñ—Ç—É—î–º–æ –¥–∞–Ω—ñ –∑ config.py
            // –í —Ä–µ–∞–ª—å–Ω–æ—Å—Ç—ñ –∫—Ä–∞—â–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É–≤–∞—Ç–∏ –∑ API
            casesData = [
                { key: "Standard Case", name: "‚ö™ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∏–π –∫–µ–π—Å", price: 100, description: "–ë–∞–∑–æ–≤–∏–π –∫–µ–π—Å –∑—ñ –∑–≤–∏—á–∞–π–Ω–∏–º–∏ —Ç–∞ —Ä—ñ–¥–∫—ñ—Å–Ω–∏–º–∏ —Å–∫—ñ–Ω–∞–º–∏" },
                { key: "Premium Case", name: "üîµ –ü—Ä–µ–º—ñ—É–º –∫–µ–π—Å", price: 500, description: "–ö–µ–π—Å –∑ –≤–∏—â–∏–º–∏ —à–∞–Ω—Å–∞–º–∏ –Ω–∞ –µ–ø—ñ—á–Ω—ñ —Å–∫—ñ–Ω–∏" },
                { key: "Elite Case", name: "üü£ –ï–ª—ñ—Ç–Ω–∏–π –∫–µ–π—Å", price: 1000, description: "–ï–∫—Å–∫–ª—é–∑–∏–≤–Ω–∏–π –∫–µ–π—Å –∑ –º–æ–∂–ª–∏–≤—ñ—Å—Ç—é –≤–∏–±–∏—Ç–∏ –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω—ñ —Å–∫—ñ–Ω–∏" },
                { key: "Ultimate Case", name: "üü† –£–ª—å—Ç–∏–º–∞—Ç –∫–µ–π—Å", price: 2500, description: "–ù–∞–π–∫—Ä–∞—â–∏–π –∫–µ–π—Å –∑ —à–∞–Ω—Å–æ–º –Ω–∞ –∞—Ä–∫–∞–Ω–Ω—ñ —Å–∫—ñ–Ω–∏!" }
            ];
            renderCasesList();
        }

        // ==================== –í–Ü–î–û–ë–†–ê–ñ–ï–ù–ù–Ø –ö–ï–ô–°–Ü–í ====================
        function renderCasesList() {
            const container = document.getElementById('casesList');
            let html = '';
            casesData.forEach(c => {
                html += `
                    <div class="case-item" onclick="selectCase('${c.key}')">
                        <div class="case-name">${c.name}</div>
                        <div class="case-price">üí∞ ${c.price} –º–æ–Ω–µ—Ç</div>
                        <div class="case-description">${c.description}</div>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        function selectCase(caseKey) {
            currentCaseKey = caseKey;
            const caseData = casesData.find(c => c.key === caseKey);
            document.getElementById('caseDetailName').innerText = caseData.name;
            document.getElementById('caseDetailDesc').innerText = caseData.description;

            // –°—Ç–≤–æ—Ä—é—î–º–æ –∫–Ω–æ–ø–∫–∏ –≤–∏–±–æ—Ä—É –∫—ñ–ª—å–∫–æ—Å—Ç—ñ
            const counts = [1, 2, 5, 10];
            let buttonsHtml = '';
            counts.forEach(count => {
                buttonsHtml += `<button class="count-btn ${count === 1 ? 'selected' : ''}" onclick="selectCount(${count})">${count}</button>`;
            });
            document.getElementById('countSelector').innerHTML = buttonsHtml;
            selectedCount = 1;

            // –ü–æ–∫–∞–∑—É—î–º–æ –µ–∫—Ä–∞–Ω –¥–µ—Ç–∞–ª–µ–π
            hideAllScreens();
            document.getElementById('caseDetailScreen').classList.remove('hidden');
        }

        function selectCount(count) {
            selectedCount = count;
            document.querySelectorAll('.count-btn').forEach(btn => {
                btn.classList.remove('selected');
                if (btn.innerText == count) btn.classList.add('selected');
            });
        }

        // ==================== –í–Ü–î–ö–†–ò–¢–¢–Ø –ö–ï–ô–°–£ ====================
        async function openCase() {
            const caseData = casesData.find(c => c.key === currentCaseKey);
            if (!caseData) return;

            document.getElementById('openCaseBtn').disabled = true;
            document.getElementById('openCaseBtn').innerText = '‚è≥ –í—ñ–¥–∫—Ä–∏—Ç—Ç—è...';

            const result = await apiCall('open_case', {
                case_key: currentCaseKey,
                count: selectedCount
            });

            document.getElementById('openCaseBtn').disabled = false;
            document.getElementById('openCaseBtn').innerText = 'üîì –í—ñ–¥–∫—Ä–∏—Ç–∏';

            if (result.success) {
                // –û–Ω–æ–≤–ª—é—î–º–æ –±–∞–ª–∞–Ω—Å
                if (result.new_balance !== undefined) {
                    updateBalanceDisplay(result.new_balance);
                }
                // –ü–æ–∫–∞–∑—É—î–º–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∏
                showResults(result.results, result.total_cost, result.new_balance);
            } else {
                alert(result.message || '–ü–æ–º–∏–ª–∫–∞ –≤—ñ–¥–∫—Ä–∏—Ç—Ç—è –∫–µ–π—Å—É');
            }
        }

        function showResults(results, totalCost, newBalance) {
            let html = '';
            results.forEach((r, index) => {
                html += `
                    <div class="result-item">
                        <div style="font-size: 24px;">${r.emoji}</div>
                        <div><strong>${r.skin_name}</strong> (${r.rarity})</div>
                        <div>üÜî ${r.skin_id} | üí∞ –ø—Ä–æ–¥–∞–∂: ${r.sell_price}</div>
                    </div>
                `;
            });
            document.getElementById('resultsList').innerHTML = html;
            document.getElementById('newBalanceResult').innerText = newBalance || '?';

            hideAllScreens();
            document.getElementById('resultScreen').classList.remove('hidden');
        }

        // ==================== –Ü–ù–í–ï–ù–¢–ê–† ====================
        async function showInventory() {
            hideAllScreens();
            document.getElementById('inventoryScreen').classList.remove('hidden');
            document.getElementById('inventoryList').innerHTML = '<div class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>';

            const data = await apiCall('get_inventory');
            if (data.success) {
                renderInventory(data.inventory);
            } else {
                document.getElementById('inventoryList').innerHTML = '<p>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—è</p>';
            }
        }

        function renderInventory(items) {
            const container = document.getElementById('inventoryList');
            if (items.length === 0) {
                container.innerHTML = '<p>–Ü–Ω–≤–µ–Ω—Ç–∞—Ä –ø–æ—Ä–æ–∂–Ω—ñ–π</p>';
                return;
            }
            let html = '';
            items.forEach(item => {
                html += `
                    <div class="inventory-item">
                        <div class="rarity">${item.emoji}</div>
                        <div class="name">${item.skin_name}</div>
                        <div class="price">üí∞ ${item.sell_price}</div>
                        <button class="sell-btn" onclick="sellSkin(${item.id})">–ü—Ä–æ–¥–∞—Ç–∏</button>
                    </div>
                `;
            });
            container.innerHTML = html;
        }

        async function sellSkin(skinId) {
            if (!confirm('–ü—Ä–æ–¥–∞—Ç–∏ —Ü–µ–π —Å–∫—ñ–Ω?')) return;
            const result = await apiCall('sell_skin', { skin_id: skinId });
            if (result.success) {
                alert(result.message);
                updateBalanceDisplay(result.new_balance);
                showInventory(); // –æ–Ω–æ–≤–∏—Ç–∏ —Å–ø–∏—Å–æ–∫
            } else {
                alert(result.message);
            }
        }

        async function sellAllInventory() {
            if (!confirm('–ü—Ä–æ–¥–∞—Ç–∏ –í–°–Ü —Å–∫—ñ–Ω–∏ –∑ —ñ–Ω–≤–µ–Ω—Ç–∞—Ä—è? –¶—é –¥—ñ—é –Ω–µ–º–æ–∂–ª–∏–≤–æ —Å–∫–∞—Å—É–≤–∞—Ç–∏.')) return;
            const result = await apiCall('sell_all');
            if (result.success) {
                alert(result.message);
                updateBalanceDisplay(result.total);
                showInventory();
            } else {
                alert(result.message);
            }
        }

        // ==================== –ü–†–û–§–Ü–õ–¨ ====================
        async function showProfile() {
            hideAllScreens();
            document.getElementById('profileScreen').classList.remove('hidden');
            document.getElementById('profileInfo').innerHTML = '<div class="loading">–ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...</div>';

            const data = await apiCall('profile');
            if (data.success) {
                const p = data.profile;
                let html = `
                    <p><strong>ID:</strong> ${p.user_id}</p>
                    <p><strong>Username:</strong> @${p.username || '–Ω–µ–º–∞—î'}</p>
                    <p><strong>–ë–∞–ª–∞–Ω—Å:</strong> ${p.balance} –º–æ–Ω–µ—Ç</p>
                    <p><strong>–†—ñ–≤–µ–Ω—å:</strong> ${p.level} (XP: ${p.xp}/100)</p>
                    <p><strong>–ó–Ω–∏–∂–∫–∞:</strong> ${p.discount}%</p>
                    <p><strong>–í—ñ–¥–∫—Ä–∏—Ç–æ –∫–µ–π—Å—ñ–≤:</strong> ${p.cases_opened}</p>
                `;
                if (p.most_expensive_skin) {
                    html += `<p><strong>–ù–∞–π–¥–æ—Ä–æ–∂—á–∏–π —Å–∫—ñ–Ω:</strong> ${p.most_expensive_skin.skin_name} (${p.most_expensive_skin.rarity}) - ${p.most_expensive_skin.case_price} –º–æ–Ω–µ—Ç</p>`;
                }
                document.getElementById('profileInfo').innerHTML = html;
            } else {
                document.getElementById('profileInfo').innerHTML = '<p>–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø—Ä–æ—Ñ—ñ–ª—é</p>';
            }
        }

        // ==================== –ú–ê–†–ö–ï–¢, –î–£–ï–õ–Ü, –¢–£–†–ù–Ü–† (–∑–∞–≥–ª—É—à–∫–∏) ====================
        function showMarket() {
            hideAllScreens();
            document.getElementById('marketScreen').classList.remove('hidden');
        }

        function showDuels() {
            hideAllScreens();
            document.getElementById('duelsScreen').classList.remove('hidden');
        }

        function showTournament() {
            hideAllScreens();
            document.getElementById('tournamentScreen').classList.remove('hidden');
        }

        // ==================== –ö–ï–ô–°–ò (–≥–æ–ª–æ–≤–Ω–∏–π –µ–∫—Ä–∞–Ω) ====================
        function showCases() {
            hideAllScreens();
            document.getElementById('casesScreen').classList.remove('hidden');
        }

        // ==================== –ù–ê–í–Ü–ì–ê–¶–Ü–Ø ====================
        function goBack() {
            hideAllScreens();
            document.getElementById('mainScreen').classList.remove('hidden');
        }

        function goBackToCases() {
            hideAllScreens();
            document.getElementById('casesScreen').classList.remove('hidden');
        }

        function hideAllScreens() {
            document.getElementById('mainScreen').classList.add('hidden');
            document.getElementById('casesScreen').classList.add('hidden');
            document.getElementById('caseDetailScreen').classList.add('hidden');
            document.getElementById('resultScreen').classList.add('hidden');
            document.getElementById('inventoryScreen').classList.add('hidden');
            document.getElementById('profileScreen').classList.add('hidden');
            document.getElementById('marketScreen').classList.add('hidden');
            document.getElementById('duelsScreen').classList.add('hidden');
            document.getElementById('tournamentScreen').classList.add('hidden');
        }

        // –î–æ–ø–æ–º—ñ–∂–Ω–∞ —Ñ—É–Ω–∫—Ü—ñ—è
        function showNotification(msg) {
            alert(msg); // –¢—É—Ç –º–æ–∂–Ω–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ –Ω–∞ –∫—Ä–∞—Å–∏–≤–µ —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è
        }
    </script>
</body>
</html>